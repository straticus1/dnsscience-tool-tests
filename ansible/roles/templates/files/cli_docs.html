<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLI Documentation - DNS Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        h2 {
            color: #667eea;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        h3 {
            color: #333;
            margin-top: 25px;
            margin-bottom: 10px;
        }

        h4 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 14px;
        }

        .content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .toc h3 {
            margin-top: 0;
            margin-bottom: 15px;
        }

        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }

        .toc ul ul {
            padding-left: 20px;
        }

        .toc li {
            margin: 8px 0;
        }

        .toc a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .toc a:hover {
            color: #5568d3;
            text-decoration: underline;
        }

        .command-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .command-title {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .command-description {
            color: #666;
            margin-bottom: 15px;
        }

        .code-block {
            position: relative;
            margin: 15px 0;
        }

        pre {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 0;
        }

        pre code {
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 6px 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s;
        }

        .copy-button:hover {
            background: #5568d3;
        }

        .copy-button.copied {
            background: #28a745;
        }

        .option-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .option-table th,
        .option-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .option-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .option-table code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 13px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .alert.info {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            color: #0c5460;
        }

        .alert.warning {
            background: #fff3cd;
            border-left: 4px solid #856404;
            color: #856404;
        }

        .alert.success {
            background: #d4edda;
            border-left: 4px solid #155724;
            color: #155724;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 50px;
            padding: 10px 15px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
            transition: background 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.05);
        }

        .theme-toggle .sun {
            font-size: 20px;
        }

        .theme-toggle .moon {
            font-size: 20px;
            display: none;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        body.dark-mode .theme-toggle {
            background: #2d2d2d;
        }

        body.dark-mode .theme-toggle .sun {
            display: none;
        }

        body.dark-mode .theme-toggle .moon {
            display: block;
        }

        body.dark-mode header,
        body.dark-mode .content {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        body.dark-mode h1,
        body.dark-mode h2,
        body.dark-mode h3,
        body.dark-mode h4 {
            color: #8b9cff;
        }

        body.dark-mode .subtitle {
            color: #b0b0b0;
        }

        body.dark-mode .toc,
        body.dark-mode .command-box {
            background: #1a1a1a;
            border-color: #444;
        }

        body.dark-mode h2 {
            border-bottom-color: #444;
        }

        body.dark-mode .command-title {
            color: #e0e0e0;
        }

        body.dark-mode .command-description {
            color: #b0b0b0;
        }

        body.dark-mode .option-table th {
            background: #1a1a1a;
            color: #e0e0e0;
        }

        body.dark-mode .option-table th,
        body.dark-mode .option-table td {
            border-bottom-color: #444;
        }

        body.dark-mode .option-table code {
            background: #1a1a1a;
            color: #8b9cff;
        }

        body.dark-mode code {
            background: #1a1a1a;
            color: #8b9cff;
        }

        .nav-bar {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            padding: 15px 30px;
            background: rgba(255,255,255,0.95);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        body.dark-mode .nav-bar {
            background: rgba(45,45,45,0.95);
        }

        .nav-button {
            padding: 8px 20px;
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .nav-button:hover {
            background: #667eea;
            color: white;
        }

        .nav-button.primary {
            background: #667eea;
            color: white;
        }

        .nav-button.primary:hover {
            background: #5568d3;
            border-color: #5568d3;
        }

        body.dark-mode .nav-button {
            color: #8b9cff;
            border-color: #8b9cff;
        }

        body.dark-mode .nav-button:hover {
            background: #8b9cff;
            color: #1a1a1a;
        }

        body.dark-mode .nav-button.primary {
            background: #8b9cff;
            color: #1a1a1a;
        }

        .search-box {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        body.dark-mode .search-box {
            background: #1a1a1a;
        }

        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 16px;
        }

        body.dark-mode .search-box input {
            background: #2d2d2d;
            border-color: #444;
            color: #e0e0e0;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        ul {
            margin: 10px 0;
            padding-left: 25px;
        }

        li {
            margin: 5px 0;
        }

        .install-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .install-box h3 {
            color: white;
            margin-top: 0;
        }

        .install-box pre {
            background: rgba(0,0,0,0.3);
            margin-top: 15px;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 8px;
        }

        .badge.new {
            background: #28a745;
            color: white;
        }

        .badge.beta {
            background: #ffc107;
            color: #333;
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <div id="themeToggle" class="theme-toggle">
        <span class="sun">‚òÄÔ∏è</span>
        <span class="moon">üåô</span>
    </div>

    <div class="container">
        <!-- Navigation Bar -->
        <div class="nav-bar">
            <a href="/" class="nav-button">Home</a>
            <a href="/docs/api" class="nav-button">API Docs</a>
            <a href="/docs/cli" class="nav-button primary">CLI Docs</a>
            <a href="/login" class="nav-button">Login</a>
            <a href="/signup" class="nav-button">Sign Up</a>
        </div>

        <header>
            <h1>CLI Documentation</h1>
            <p class="subtitle">Command-line interface for DNS Science - Monitor and analyze DNS security from your terminal</p>
        </header>

        <div class="content">
            <!-- Search Box -->
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Search documentation..." onkeyup="searchDocs()">
            </div>

            <!-- Table of Contents -->
            <div class="toc">
                <h3>Table of Contents</h3>
                <ul>
                    <li><a href="#dnsscience-util">DNSScience-Util <span class="badge new">NEW</span></a>
                        <ul>
                            <li><a href="#util-overview">Overview</a></li>
                            <li><a href="#util-features">Key Features</a></li>
                            <li><a href="#util-installation">Installation</a></li>
                            <li><a href="#util-usage">Basic Usage</a></li>
                            <li><a href="#util-advanced">Advanced Features</a></li>
                            <li><a href="#util-examples">Usage Examples</a></li>
                        </ul>
                    </li>
                    <li><a href="#dnsscience-cli">DNSScience CLI</a>
                        <ul>
                            <li><a href="#installation">Installation</a></li>
                            <li><a href="#getting-started">Getting Started</a></li>
                            <li><a href="#authentication">Authentication</a></li>
                        </ul>
                    </li>
                    <li><a href="#commands">Command Reference</a>
                        <ul>
                            <li><a href="#cmd-scan">dnsscience scan</a></li>
                            <li><a href="#cmd-search">dnsscience search</a></li>
                            <li><a href="#cmd-history">dnsscience history</a></li>
                            <li><a href="#cmd-watch">dnsscience watch</a></li>
                            <li><a href="#cmd-ip">dnsscience ip</a> <span class="badge new">NEW</span>
                                <ul>
                                    <li><a href="#cmd-ip-scan">dnsscience ip scan</a></li>
                                    <li><a href="#cmd-ip-reputation">dnsscience ip reputation</a></li>
                                    <li><a href="#cmd-ip-asn">dnsscience ip asn</a></li>
                                </ul>
                            </li>
                            <li><a href="#cmd-login">dnsscience login</a></li>
                            <li><a href="#cmd-config">dnsscience config</a></li>
                            <li><a href="#cmd-export">dnsscience export</a></li>
                            <li><a href="#cmd-stats">dnsscience stats</a></li>
                        </ul>
                    </li>
                    <li><a href="#configuration">Configuration</a></li>
                    <li><a href="#output-formats">Output Formats</a></li>
                    <li><a href="#examples">Examples & Use Cases</a></li>
                </ul>
            </div>

            <!-- DNSScience-Util Section -->
            <section id="dnsscience-util">
                <h2>DNSScience-Util: Advanced DNS Analysis Toolkit <span class="badge new">NEW</span></h2>

                <div class="alert success">
                    <strong>The World's Most Advanced DNS Analysis, Security, Testing, and Debugging Tool</strong><br>
                    DNSScience-Util is a comprehensive suite of DNS utilities that combine into an incredibly powerful global debugging toolkit. Think of it as <code>dig</code> + <code>ldns</code> + advanced security analysis + global testing capabilities - all integrated with the DNSScience.io platform.
                </div>

                <!-- Overview -->
                <div id="util-overview">
                    <h3>Overview</h3>
                    <p>DNSScience-Util is not just one tool - it's a complete ecosystem of DNS utilities that work together to provide unparalleled DNS analysis and debugging capabilities. Whether you're a network administrator, security researcher, DevOps engineer, or DNS professional, this toolkit gives you comprehensive visibility into DNS operations worldwide.</p>

                    <p><strong>GitHub Repository:</strong> <a href="https://github.com/straticus1/dnsscience-tool-tests" target="_blank">https://github.com/straticus1/dnsscience-tool-tests</a></p>
                </div>

                <!-- Key Features -->
                <div id="util-features">
                    <h3>Key Features & Capabilities</h3>

                    <h4>üåê Core DNS Operations</h4>
                    <ul>
                        <li><strong>Universal DNS Queries</strong> - Query any record type (A, AAAA, MX, TXT, CNAME, NS, SOA, PTR, CAA, TLSA, and more)</li>
                        <li><strong>DNSSEC Validation</strong> - Complete DNSSEC chain validation with detailed error reporting</li>
                        <li><strong>Zone Transfers</strong> - AXFR/IXFR support for zone enumeration</li>
                        <li><strong>Delegation Path Tracing</strong> - Follow DNS delegation paths from root to authoritative nameservers</li>
                        <li><strong>Reverse DNS Analysis</strong> - PTR record lookups and validation</li>
                    </ul>

                    <h4>üîç Advanced Analysis</h4>
                    <ul>
                        <li><strong>Global Resolver Testing</strong> - Test against 258+ resolvers worldwide across all continents</li>
                        <li><strong>DNSSEC Chain Validation</strong> - Verify complete DNSSEC trust chains</li>
                        <li><strong>Zone Walking</strong> - NSEC/NSEC3 zone enumeration</li>
                        <li><strong>DANE/TLSA Validation</strong> - Certificate validation via DNS</li>
                        <li><strong>Encrypted DNS Support</strong> - DNS-over-HTTPS (DoH) and DNS-over-TLS (DoT)</li>
                        <li><strong>DNS Performance Testing</strong> - Latency analysis and resolver performance metrics</li>
                    </ul>

                    <h4>üõ°Ô∏è Security Features</h4>
                    <ul>
                        <li><strong>DNS Hijacking Detection</strong> - Identify DNS poisoning and man-in-the-middle attacks</li>
                        <li><strong>Cache Poisoning Assessment</strong> - Test resolver vulnerability to cache poisoning</li>
                        <li><strong>Anomaly Detection</strong> - Identify suspicious DNS responses and configurations</li>
                        <li><strong>Security Scoring</strong> - Comprehensive DNS security posture assessment</li>
                        <li><strong>Threat Intelligence Integration</strong> - Check domains against known threat feeds</li>
                    </ul>

                    <h4>üìä Output & Integration</h4>
                    <ul>
                        <li><strong>Multiple Output Formats</strong> - Text (dig-style), JSON, YAML, short format</li>
                        <li><strong>Cloud Integration</strong> - Direct integration with DNSScience.io platform</li>
                        <li><strong>Comprehensive Logging</strong> - Detailed logging for debugging and audit trails</li>
                        <li><strong>Configuration Files</strong> - Save and reuse complex query configurations</li>
                        <li><strong>Batch Processing</strong> - Process multiple domains efficiently</li>
                    </ul>
                </div>

                <!-- Installation -->
                <div id="util-installation">
                    <h3>Installation</h3>

                    <div class="alert info">
                        <strong>Requirements:</strong> Python 3.8+ and pip package manager
                    </div>

                    <h4>Quick Install from GitHub</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Clone the repository
git clone https://github.com/straticus1/dnsscience-tool-tests.git
cd dnsscience-tool-tests

# Install dependencies
pip install -r requirements.txt

# Make executable
chmod +x dnsscience-util.py

# Verify installation
./dnsscience-util.py --version</code></pre>
                    </div>

                    <h4>Alternative: Direct Download</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Download the tool
curl -L -o dnsscience-util.py https://raw.githubusercontent.com/straticus1/dnsscience-tool-tests/main/dnsscience-util.py

# Install dependencies
pip install dnspython requests pyyaml

# Make executable
chmod +x dnsscience-util.py</code></pre>
                    </div>
                </div>

                <!-- Basic Usage -->
                <div id="util-usage">
                    <h3>Basic Usage</h3>

                    <p>DNSScience-Util uses a familiar command-line interface inspired by <code>dig</code> but with significantly more power:</p>

                    <h4>Simple DNS Queries</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Basic A record query
./dnsscience-util.py example.com

# Query specific record type
./dnsscience-util.py example.com MX
./dnsscience-util.py example.com AAAA
./dnsscience-util.py example.com TXT

# Query specific nameserver
./dnsscience-util.py example.com @1.1.1.1
./dnsscience-util.py example.com @8.8.8.8

# Reverse DNS lookup
./dnsscience-util.py -x 8.8.8.8
./dnsscience-util.py -x 2001:4860:4860::8888</code></pre>
                    </div>

                    <h4>DNSSEC Validation</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Check DNSSEC status
./dnsscience-util.py example.com +dnssec

# Validate DNSSEC chain
./dnsscience-util.py --validate example.com

# Get DNSKEY records
./dnsscience-util.py example.com DNSKEY

# Get DS records
./dnsscience-util.py example.com DS</code></pre>
                    </div>

                    <h4>Output Formats</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># JSON output for scripting
./dnsscience-util.py example.com +json

# YAML output
./dnsscience-util.py example.com +yaml

# Short format (answers only)
./dnsscience-util.py example.com +short

# Verbose output with details
./dnsscience-util.py example.com +verbose</code></pre>
                    </div>
                </div>

                <!-- Advanced Features -->
                <div id="util-advanced">
                    <h3>Advanced Features</h3>

                    <h4>üåç Global Resolver Testing</h4>
                    <p>Test your domain against 258+ public resolvers worldwide to ensure consistent DNS resolution:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Test against all global resolvers
./dnsscience-util.py --global-test example.com

# Test specific regions
./dnsscience-util.py --global-test example.com --region asia
./dnsscience-util.py --global-test example.com --region europe

# Compare results across regions
./dnsscience-util.py --global-test example.com --compare

# Export results
./dnsscience-util.py --global-test example.com +json > global-test.json</code></pre>
                    </div>

                    <div class="alert info">
                        <strong>Supported Regions:</strong> North America, South America, Europe, Asia, Middle East, Africa, Oceania, Russia/CIS
                    </div>

                    <h4>üîí Security Analysis</h4>
                    <p>Comprehensive security assessment of DNS configurations:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Full security analysis
./dnsscience-util.py --security-analyze example.com

# Check for DNS hijacking
./dnsscience-util.py --check-hijacking example.com

# Test cache poisoning vulnerability
./dnsscience-util.py --test-cache-poisoning example.com @resolver-ip

# Anomaly detection
./dnsscience-util.py --detect-anomalies example.com

# Generate security report
./dnsscience-util.py --security-analyze example.com --report pdf</code></pre>
                    </div>

                    <h4>üîê Encrypted DNS</h4>
                    <p>Query using DNS-over-HTTPS (DoH) or DNS-over-TLS (DoT):</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># DNS-over-HTTPS (DoH)
./dnsscience-util.py --doh https://cloudflare-dns.com/dns-query example.com
./dnsscience-util.py --doh https://dns.google/dns-query example.com

# DNS-over-TLS (DoT)
./dnsscience-util.py --dot dns.google example.com
./dnsscience-util.py --dot 1.1.1.1 example.com

# Compare encrypted vs standard DNS
./dnsscience-util.py --compare-protocols example.com</code></pre>
                    </div>

                    <h4>üìà Performance Testing</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Measure query latency
./dnsscience-util.py --benchmark example.com

# Compare resolver performance
./dnsscience-util.py --compare-resolvers example.com

# Stress test
./dnsscience-util.py --stress-test example.com --queries 1000</code></pre>
                    </div>

                    <h4>üîç Zone Analysis</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Zone transfer (AXFR)
./dnsscience-util.py --axfr example.com @nameserver

# Zone walking (NSEC/NSEC3)
./dnsscience-util.py --walk-zone example.com

# Enumerate subdomains
./dnsscience-util.py --enumerate example.com</code></pre>
                    </div>

                    <h4>üéØ DANE/TLSA Validation</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Validate TLSA records
./dnsscience-util.py --tlsa-check _443._tcp.example.com

# Full DANE validation
./dnsscience-util.py --dane-validate example.com 443</code></pre>
                    </div>
                </div>

                <!-- Usage Examples -->
                <div id="util-examples">
                    <h3>Real-World Usage Examples</h3>

                    <h4>Example 1: Troubleshoot Global DNS Issues</h4>
                    <p>Your users in Asia report different content than users in Europe. Test DNS resolution worldwide:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Test globally and compare results
./dnsscience-util.py --global-test myapp.example.com --compare +json > global-dns-test.json

# Identify inconsistencies
cat global-dns-test.json | jq '.inconsistencies'

# Generate visual report
./dnsscience-util.py --global-test myapp.example.com --report html</code></pre>
                    </div>

                    <h4>Example 2: Security Audit Before Production</h4>
                    <p>Comprehensive DNS security check before launching a new service:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">#!/bin/bash
# dns-security-audit.sh

DOMAIN="newservice.example.com"

echo "Starting DNS Security Audit for $DOMAIN"
echo "========================================"

# 1. DNSSEC Validation
echo "1. Checking DNSSEC..."
./dnsscience-util.py --validate $DOMAIN

# 2. Security Analysis
echo "2. Running security analysis..."
./dnsscience-util.py --security-analyze $DOMAIN

# 3. Global Consistency
echo "3. Testing global DNS consistency..."
./dnsscience-util.py --global-test $DOMAIN --compare

# 4. Encrypted DNS Check
echo "4. Testing encrypted DNS..."
./dnsscience-util.py --doh https://cloudflare-dns.com/dns-query $DOMAIN

# 5. Performance Check
echo "5. Benchmarking DNS performance..."
./dnsscience-util.py --benchmark $DOMAIN

echo "Audit complete!"</code></pre>
                    </div>

                    <h4>Example 3: Monitor DNS Changes</h4>
                    <p>Continuous monitoring to detect unauthorized DNS changes:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">#!/bin/bash
# dns-monitor.sh

DOMAIN="critical.example.com"
BASELINE_FILE="dns-baseline.json"
ALERT_WEBHOOK="https://hooks.slack.com/your-webhook"

# Create baseline (run once)
if [ ! -f "$BASELINE_FILE" ]; then
    ./dnsscience-util.py $DOMAIN +json > $BASELINE_FILE
    echo "Baseline created for $DOMAIN"
    exit 0
fi

# Check current state
CURRENT=$(./dnsscience-util.py $DOMAIN +json)

# Compare with baseline
if ! diff -q <(echo "$CURRENT") "$BASELINE_FILE" > /dev/null; then
    echo "‚ö†Ô∏è  DNS CHANGE DETECTED for $DOMAIN"

    # Send alert
    curl -X POST -H 'Content-type: application/json' \
        --data '{"text":"DNS change detected for '$DOMAIN'"}' \
        $ALERT_WEBHOOK

    # Log changes
    echo "$CURRENT" > "dns-change-$(date +%Y%m%d-%H%M%S).json"
fi</code></pre>
                    </div>

                    <h4>Example 4: Bulk Domain Analysis</h4>
                    <p>Analyze DNS configuration for multiple domains:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">#!/bin/bash
# bulk-dns-analysis.sh

DOMAINS_FILE="domains.txt"
OUTPUT_DIR="dns-reports"
mkdir -p "$OUTPUT_DIR"

while IFS= read -r domain; do
    echo "Analyzing $domain..."

    # Full analysis with all features
    ./dnsscience-util.py --security-analyze "$domain" \
        --global-test \
        +json > "$OUTPUT_DIR/${domain}-report.json"

    # Extract security score
    SCORE=$(jq -r '.security_score' "$OUTPUT_DIR/${domain}-report.json")
    echo "$domain: Security Score = $SCORE"

done < "$DOMAINS_FILE"

echo "Bulk analysis complete. Reports saved to $OUTPUT_DIR/"</code></pre>
                    </div>

                    <h4>Example 5: CI/CD Integration</h4>
                    <p>Integrate DNS validation into your deployment pipeline:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-yaml">{% raw %}# .github/workflows/dns-validation.yml
name: DNS Validation

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate-dns:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'

      - name: Install DNSScience-Util
        run: |
          git clone https://github.com/straticus1/dnsscience-tool-tests.git
          cd dnsscience-tool-tests
          pip install -r requirements.txt
          chmod +x dnsscience-util.py

      - name: Validate DNS Configuration
        run: |
          cd dnsscience-tool-tests

          # Validate DNSSEC
          ./dnsscience-util.py --validate ${{ vars.DOMAIN }}

          # Security check
          ./dnsscience-util.py --security-analyze ${{ vars.DOMAIN }} +json > security-report.json

          # Check security score
          SCORE=$(jq -r '.security_score' security-report.json)
          if [ "$SCORE" -lt 80 ]; then
            echo "‚ùå DNS Security score ($SCORE) below threshold (80)"
            exit 1
          fi

          echo "‚úÖ DNS validation passed (Score: $SCORE)"

      - name: Upload Report
        uses: actions/upload-artifact@v2
        with:
          name: dns-security-report
          path: dnsscience-tool-tests/security-report.json{% endraw %}</code></pre>
                    </div>
                </div>

                <div class="alert success">
                    <strong>Integration with DNSScience.io Platform</strong><br>
                    DNSScience-Util seamlessly integrates with the DNSScience.io web platform. Results can be automatically uploaded, historical data retrieved, and analysis enhanced with cloud-based threat intelligence and global monitoring capabilities.
                </div>
            </section>

            <!-- DNSScience CLI Section -->
            <section id="dnsscience-cli">
                <h2>DNSScience CLI</h2>
                <p>The DNSScience CLI provides direct integration with your DNSScience.io account for managing scans, monitoring domains, and accessing your scan history.</p>
            </section>

            <!-- Installation -->
            <section id="installation">
                <h2>Installation</h2>

                <div class="alert info">
                    <strong>System Requirements:</strong> Python 3.8 or higher is required.
                </div>

                <div class="install-box">
                    <h3>Installation</h3>
                    <p>The DNS Science CLI is currently available for local installation. Download and install:</p>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Download CLI package
curl -O https://dnsscience.io/downloads/dnsscience-cli-latest.tar.gz

# Extract and install
tar -xzf dnsscience-cli-latest.tar.gz
cd dnsscience-cli
pip install -e .</code></pre>
                    </div>
                </div>

                <h3>Alternative Installation Methods</h3>

                <h4>Install directly from local directory (if you have the code):</h4>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">cd /path/to/dnsscience-cli
pip install -e .</code></pre>
                </div>

                <div class="alert warning">
                    <strong>Note:</strong> PyPI package coming soon. For now, please use the local installation method above.
                </div>
            </section>

            <!-- Getting Started -->
            <section id="getting-started">
                <h2>Getting Started</h2>

                <p>After installation, verify the CLI is working:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">dnsscience --version
dnsscience --help</code></pre>
                </div>

                <h3>Quick Start Example</h3>
                <p>Scan your first domain:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash"># Scan a domain
dnsscience scan example.com

# Scan with detailed output
dnsscience scan example.com --verbose

# Scan and save results to JSON
dnsscience scan example.com --output json --save results.json</code></pre>
                </div>
            </section>

            <!-- Authentication -->
            <section id="authentication">
                <h2>Authentication</h2>

                <p>To access premium features and save scan history to your account, you need to authenticate:</p>

                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash"># Login with email and password
dnsscience login

# Login with API key
dnsscience login --api-key YOUR_API_KEY

# Check authentication status
dnsscience auth status

# Logout
dnsscience logout</code></pre>
                </div>

                <div class="alert info">
                    <strong>Note:</strong> Authentication credentials are stored securely in your system's keychain or encrypted configuration file.
                </div>
            </section>

            <!-- Command Reference -->
            <section id="commands">
                <h2>Command Reference</h2>

                <!-- SCAN Command -->
                <div id="cmd-scan" class="command-box">
                    <div class="command-title">dnsscience scan [DOMAIN]</div>
                    <div class="command-description">Scan a domain for DNS security configurations including DNSSEC, SPF, DKIM, DMARC, MTA-STS, and SSL certificates.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience scan example.com [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                                <th>Default</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>--ssl</code> / <code>--no-ssl</code></td>
                                <td>Include/exclude SSL certificate scanning</td>
                                <td>true</td>
                            </tr>
                            <tr>
                                <td><code>-o, --output</code></td>
                                <td>Output format: table, json, csv, yaml</td>
                                <td>table</td>
                            </tr>
                            <tr>
                                <td><code>-s, --save</code></td>
                                <td>Save results to file</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>-v, --verbose</code></td>
                                <td>Show detailed output</td>
                                <td>false</td>
                            </tr>
                            <tr>
                                <td><code>--quiet</code></td>
                                <td>Minimal output</td>
                                <td>false</td>
                            </tr>
                            <tr>
                                <td><code>--timeout</code></td>
                                <td>Request timeout in seconds</td>
                                <td>60</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Basic scan
dnsscience scan example.com

# Scan with JSON output
dnsscience scan example.com --output json

# Scan and save to file
dnsscience scan example.com --output json --save scan-results.json

# Scan without SSL checks
dnsscience scan example.com --no-ssl

# Verbose scan
dnsscience scan example.com --verbose</code></pre>
                    </div>
                </div>

                <!-- SEARCH Command -->
                <div id="cmd-search" class="command-box">
                    <div class="command-title">dnsscience search [QUERY]</div>
                    <div class="command-description">Search for domains in the DNS Science database.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience search [QUERY] [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                                <th>Default</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>-l, --limit</code></td>
                                <td>Maximum number of results</td>
                                <td>50</td>
                            </tr>
                            <tr>
                                <td><code>--dnssec</code></td>
                                <td>Filter by DNSSEC status (true/false)</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>--spf</code></td>
                                <td>Filter by SPF status (true/false)</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>--ssl-grade</code></td>
                                <td>Filter by SSL grade (A+, A, B, etc.)</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>-o, --output</code></td>
                                <td>Output format: table, json, csv</td>
                                <td>table</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Search for domains
dnsscience search google

# Search with filters
dnsscience search --dnssec true --spf true

# Search with SSL grade filter
dnsscience search --ssl-grade A+

# Search and limit results
dnsscience search example --limit 10</code></pre>
                    </div>
                </div>

                <!-- HISTORY Command -->
                <div id="cmd-history" class="command-box">
                    <div class="command-title">dnsscience history [DOMAIN]</div>
                    <div class="command-description">View scan history for a domain to track configuration changes over time.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience history example.com [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                                <th>Default</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>-l, --limit</code></td>
                                <td>Number of historical entries</td>
                                <td>10</td>
                            </tr>
                            <tr>
                                <td><code>--compare</code></td>
                                <td>Show changes between scans</td>
                                <td>false</td>
                            </tr>
                            <tr>
                                <td><code>--from</code></td>
                                <td>Start date (YYYY-MM-DD)</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>--to</code></td>
                                <td>End date (YYYY-MM-DD)</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>-o, --output</code></td>
                                <td>Output format: table, json, csv</td>
                                <td>table</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># View recent history
dnsscience history example.com

# View last 20 scans
dnsscience history example.com --limit 20

# Show changes between scans
dnsscience history example.com --compare

# Filter by date range
dnsscience history example.com --from 2025-01-01 --to 2025-11-09</code></pre>
                    </div>
                </div>

                <!-- WATCH Command -->
                <div id="cmd-watch" class="command-box">
                    <div class="command-title">dnsscience watch [DOMAIN] <span class="badge new">NEW</span></div>
                    <div class="command-description">Monitor a domain for configuration changes in real-time.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience watch example.com [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                                <th>Default</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>-i, --interval</code></td>
                                <td>Scan interval in seconds</td>
                                <td>300</td>
                            </tr>
                            <tr>
                                <td><code>--notify</code></td>
                                <td>Send notifications on changes</td>
                                <td>false</td>
                            </tr>
                            <tr>
                                <td><code>--email</code></td>
                                <td>Email address for notifications</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td><code>--webhook</code></td>
                                <td>Webhook URL for notifications</td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Monitor domain every 5 minutes
dnsscience watch example.com --interval 300

# Monitor with email notifications
dnsscience watch example.com --notify --email admin@example.com

# Monitor with webhook
dnsscience watch example.com --webhook https://hooks.slack.com/...</code></pre>
                    </div>
                </div>

                <!-- LOGIN Command -->
                <div id="cmd-login" class="command-box">
                    <div class="command-title">dnsscience login</div>
                    <div class="command-description">Authenticate with DNS Science to access premium features and save scan history.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience login [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>--email</code></td>
                                <td>Email address (will prompt if not provided)</td>
                            </tr>
                            <tr>
                                <td><code>--api-key</code></td>
                                <td>Login with API key instead of email/password</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Interactive login
dnsscience login

# Login with email
dnsscience login --email user@example.com

# Login with API key
dnsscience login --api-key sk_live_abc123...</code></pre>
                    </div>
                </div>

                <!-- CONFIG Command -->
                <div id="cmd-config" class="command-box">
                    <div class="command-title">dnsscience config</div>
                    <div class="command-description">Configure CLI settings and preferences.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience config [SUBCOMMAND]</code></pre>
                    </div>

                    <h4>Subcommands</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Subcommand</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>set</code></td>
                                <td>Set a configuration value</td>
                            </tr>
                            <tr>
                                <td><code>get</code></td>
                                <td>Get a configuration value</td>
                            </tr>
                            <tr>
                                <td><code>list</code></td>
                                <td>List all configuration values</td>
                            </tr>
                            <tr>
                                <td><code>reset</code></td>
                                <td>Reset to default configuration</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># List all settings
dnsscience config list

# Set default output format
dnsscience config set output_format json

# Set API endpoint
dnsscience config set api_url https://dnsscience.com/api

# Get current setting
dnsscience config get output_format

# Reset to defaults
dnsscience config reset</code></pre>
                    </div>
                </div>

                <!-- EXPORT Command -->
                <div id="cmd-export" class="command-box">
                    <div class="command-title">dnsscience export [DOMAIN] <span class="badge beta">BETA</span></div>
                    <div class="command-description">Export scan data in various formats for reporting and analysis.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience export example.com [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                                <th>Default</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>-f, --format</code></td>
                                <td>Export format: json, csv, pdf, html</td>
                                <td>json</td>
                            </tr>
                            <tr>
                                <td><code>-o, --output</code></td>
                                <td>Output file path</td>
                                <td>stdout</td>
                            </tr>
                            <tr>
                                <td><code>--include-history</code></td>
                                <td>Include historical data</td>
                                <td>false</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Export to JSON
dnsscience export example.com --format json --output report.json

# Export to PDF report
dnsscience export example.com --format pdf --output report.pdf

# Export with history
dnsscience export example.com --include-history --output full-report.json</code></pre>
                    </div>
                </div>

                <!-- STATS Command -->
                <div id="cmd-stats" class="command-box">
                    <div class="command-title">dnsscience stats</div>
                    <div class="command-description">Display DNS Science platform statistics and your usage metrics.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience stats [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>--live</code></td>
                                <td>Show live platform statistics</td>
                            </tr>
                            <tr>
                                <td><code>--user</code></td>
                                <td>Show your usage statistics</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Show platform statistics
dnsscience stats --live

# Show your usage
dnsscience stats --user</code></pre>
                    </div>
                </div>

                <!-- IP Command -->
                <div id="cmd-ip" class="command-box">
                    <div class="command-title">dnsscience ip <span class="badge new">NEW</span></div>
                    <div class="command-description">IP address intelligence operations including geolocation, BGP routing, reputation, and threat analysis.</div>

                    <h4>Subcommands</h4>
                    <ul>
                        <li><code>scan</code> - Comprehensive IP address scan</li>
                        <li><code>reputation</code> - Quick reputation check</li>
                        <li><code>asn</code> - Autonomous System information lookup</li>
                    </ul>
                </div>

                <!-- IP SCAN Command -->
                <div id="cmd-ip-scan" class="command-box">
                    <div class="command-title">dnsscience ip scan</div>
                    <div class="command-description">Perform a comprehensive scan of an IP address including geolocation, network info, BGP routing, reputation, and blacklist checks.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience ip scan &lt;ip_address&gt; [OPTIONS]</code></pre>
                    </div>

                    <h4>Options</h4>
                    <table class="option-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>--format</code></td>
                                <td>Output format: table, json (default: table)</td>
                            </tr>
                            <tr>
                                <td><code>--expert</code></td>
                                <td><span class="badge new">NEW</span> Enable Expert mode with customizable intelligence sources (geo, security, advanced analysis)</td>
                            </tr>
                            <tr>
                                <td><code>--force</code></td>
                                <td>Force fresh scan, bypass cache</td>
                            </tr>
                            <tr>
                                <td><code>--advanced</code></td>
                                <td><span class="badge new">NEW</span> Enable advanced mode with Cloudflare DNS intelligence, privacy detection (VPN/Proxy/Tor/Hosting), enhanced BGP analysis, and comprehensive RBL checks</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Standard scan
dnsscience ip scan 8.8.8.8

# Advanced scan with all intelligence sources
dnsscience ip scan 1.1.1.1 --advanced

# Expert mode with customizable intelligence sources
dnsscience ip scan 8.8.8.8 --expert

# Advanced scan with JSON output
dnsscience ip scan 45.33.32.156 --advanced --format json

# Expert mode with JSON output
dnsscience ip scan 1.1.1.1 --expert --format json

# Force fresh advanced scan
dnsscience ip scan 8.8.4.4 --advanced --force</code></pre>
                    </div>

                    <h4>Output Information</h4>
                    <ul>
                        <li><strong>Geolocation:</strong> Country, region, city, coordinates, timezone</li>
                        <li><strong>Network:</strong> ASN, organization, ISP, reverse DNS</li>
                        <li><strong>Privacy Detection (Advanced):</strong> VPN, Proxy, Tor exit node, Hosting/datacenter detection</li>
                        <li><strong>BGP Routing:</strong> Prefix, origin ASN, announcement status, RPKI validation</li>
                        <li><strong>Reputation:</strong> Abuse confidence score, total reports, threat categories, blacklist hits</li>
                        <li><strong>Security:</strong> Tor/Proxy/VPN detection, RBL checks</li>
                        <li><strong>WHOIS:</strong> Registration country, holder information</li>
                    </ul>
                </div>

                <!-- IP REPUTATION Command -->
                <div id="cmd-ip-reputation" class="command-box">
                    <div class="command-title">dnsscience ip reputation</div>
                    <div class="command-description">Quick reputation check for an IP address. Returns abuse confidence, reports, and blacklist status.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience ip reputation &lt;ip_address&gt;</code></pre>
                    </div>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Check IP reputation
dnsscience ip reputation 185.220.101.15

# Multiple IPs
for ip in 8.8.8.8 1.1.1.1 45.33.32.156; do
    dnsscience ip reputation $ip
done</code></pre>
                    </div>

                    <h4>Reputation Scoring</h4>
                    <div class="alert info">
                        <ul>
                            <li><strong>0-24:</strong> Low risk (safe)</li>
                            <li><strong>25-74:</strong> Medium risk (caution)</li>
                            <li><strong>75-100:</strong> High risk (dangerous)</li>
                        </ul>
                    </div>
                </div>

                <!-- IP ASN Command -->
                <div id="cmd-ip-asn" class="command-box">
                    <div class="command-title">dnsscience ip asn</div>
                    <div class="command-description">Get Autonomous System information by ASN number.</div>

                    <h4>Usage</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash">dnsscience ip asn &lt;asn_number&gt;</code></pre>
                    </div>

                    <h4>Examples</h4>
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre><code class="language-bash"># Google ASN
dnsscience ip asn 15169

# Cloudflare ASN
dnsscience ip asn 13335

# Amazon ASN
dnsscience ip asn 16509</code></pre>
                    </div>

                    <h4>Output Information</h4>
                    <ul>
                        <li>ASN name and description</li>
                        <li>Organization and country</li>
                        <li>Number of announced prefixes</li>
                        <li>List of IP prefixes</li>
                    </ul>
                </div>

                <div class="alert success">
                    <strong>Advanced IP Scanning with dnsscience-util:</strong><br>
                    For even more powerful IP scanning capabilities, use <code>dnsscience-util</code>:
                    <div style="margin-top: 10px;">
                        <code>dnsscience-util --ip-scan 8.8.8.8</code><br>
                        <code>dnsscience-util --ip-scan 1.1.1.1 --ip-advanced</code> <span class="badge new">NEW</span><br>
                        <code>dnsscience-util --ip-range 192.168.1.0/24</code><br>
                        <code>dnsscience-util --ip-bgp 1.1.1.1</code><br>
                        <code>dnsscience-util --ip-asn 15169</code>
                    </div>
                    <div style="margin-top: 10px; font-size: 13px;">
                        <strong>Note:</strong> Use <code>--ip-advanced</code> to enable Cloudflare API integration, privacy detection, and comprehensive threat intelligence from AbuseIPDB and IPInfo.io
                    </div>
                </div>
            </section>

            <!-- Configuration -->
            <section id="configuration">
                <h2>Configuration</h2>

                <p>The CLI stores configuration in <code>~/.dnsscience/config.json</code>. You can edit this file directly or use the <code>dnsscience config</code> command.</p>

                <h3>Available Settings</h3>
                <table class="option-table">
                    <thead>
                        <tr>
                            <th>Setting</th>
                            <th>Description</th>
                            <th>Default</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>api_url</code></td>
                            <td>API endpoint URL</td>
                            <td>https://dnsscience.com/api</td>
                        </tr>
                        <tr>
                            <td><code>output_format</code></td>
                            <td>Default output format</td>
                            <td>table</td>
                        </tr>
                        <tr>
                            <td><code>timeout</code></td>
                            <td>Request timeout (seconds)</td>
                            <td>60</td>
                        </tr>
                        <tr>
                            <td><code>color</code></td>
                            <td>Enable colored output</td>
                            <td>true</td>
                        </tr>
                        <tr>
                            <td><code>verify_ssl</code></td>
                            <td>Verify SSL certificates</td>
                            <td>true</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Example Configuration File</h3>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-json">{
  "api_url": "https://dnsscience.com/api",
  "output_format": "json",
  "timeout": 60,
  "color": true,
  "verify_ssl": true,
  "default_scan_options": {
    "check_ssl": true,
    "verbose": false
  }
}</code></pre>
                </div>
            </section>

            <!-- Output Formats -->
            <section id="output-formats">
                <h2>Output Formats</h2>

                <p>The CLI supports multiple output formats for different use cases:</p>

                <h3>Table Format (Default)</h3>
                <p>Human-readable table output for terminal viewing:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">dnsscience scan example.com --output table</code></pre>
                </div>

                <h3>JSON Format</h3>
                <p>Machine-readable JSON for programmatic processing:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">dnsscience scan example.com --output json</code></pre>
                </div>

                <h3>CSV Format</h3>
                <p>Comma-separated values for spreadsheet import:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">dnsscience scan example.com --output csv</code></pre>
                </div>

                <h3>YAML Format</h3>
                <p>YAML output for configuration management:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">dnsscience scan example.com --output yaml</code></pre>
                </div>
            </section>

            <!-- Examples & Use Cases -->
            <section id="examples">
                <h2>Examples & Use Cases</h2>

                <h3>1. Daily Security Audit</h3>
                <p>Scan your domains daily and save results for compliance:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">#!/bin/bash
# daily-audit.sh

DOMAINS=("example.com" "api.example.com" "mail.example.com")
DATE=$(date +%Y-%m-%d)
OUTPUT_DIR="./audit-reports/$DATE"

mkdir -p "$OUTPUT_DIR"

for domain in "${DOMAINS[@]}"; do
  echo "Scanning $domain..."
  dnsscience scan "$domain" \
    --output json \
    --save "$OUTPUT_DIR/$domain.json"
done

echo "Audit complete. Reports saved to $OUTPUT_DIR"</code></pre>
                </div>

                <h3>2. Monitor Critical Domains</h3>
                <p>Set up continuous monitoring with notifications:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash"># Monitor production domain
dnsscience watch production.example.com \
  --interval 300 \
  --notify \
  --email security@example.com \
  --webhook https://hooks.slack.com/services/YOUR/WEBHOOK/URL</code></pre>
                </div>

                <h3>3. Generate Compliance Report</h3>
                <p>Export comprehensive reports for compliance audits:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash"># Generate PDF report with history
dnsscience export example.com \
  --format pdf \
  --include-history \
  --output compliance-report-$(date +%Y-%m-%d).pdf</code></pre>
                </div>

                <h3>4. Batch Domain Analysis</h3>
                <p>Analyze multiple domains from a file:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">#!/bin/bash
# batch-scan.sh

while IFS= read -r domain; do
  echo "Scanning $domain..."
  dnsscience scan "$domain" --output json >> all-results.json
done < domains.txt</code></pre>
                </div>

                <h3>5. CI/CD Integration</h3>
                <p>Integrate DNS security checks in your CI/CD pipeline:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-yaml">{% raw %}# .github/workflows/dns-security.yml
name: DNS Security Check

on:
  schedule:
    - cron: '0 0 * * *'  # Daily at midnight

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - name: Download and Install DNS Science CLI
        run: |
          curl -O https://dnsscience.io/downloads/dnsscience-cli-latest.tar.gz
          tar -xzf dnsscience-cli-latest.tar.gz
          cd dnsscience-cli
          pip install -e .

      - name: Configure API
        run: dnsscience config-set --api-key ${{ secrets.DNSSCIENCE_API_KEY }}

      - name: Scan domain
        run: |
          dnsscience scan example.com --json > results.json

      - name: Upload results
        uses: actions/upload-artifact@v2
        with:
          name: dns-scan-results
          path: results.json{% endraw %}</code></pre>
                </div>

                <h3>6. Compare Historical Changes</h3>
                <p>Track DNS configuration drift over time:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash"># View changes in last 30 days
dnsscience history example.com \
  --from $(date -d '30 days ago' +%Y-%m-%d) \
  --to $(date +%Y-%m-%d) \
  --compare</code></pre>
                </div>

                <h3>7. Security Scorecard</h3>
                <p>Generate a security scorecard for multiple domains:</p>
                <div class="code-block">
                    <button class="copy-button" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-bash">#!/bin/bash
# security-scorecard.sh

echo "Domain,DNSSEC,SPF,DKIM,MTA-STS,STARTTLS" > scorecard.csv

for domain in $(cat domains.txt); do
  result=$(dnsscience scan "$domain" --output json --quiet)
  dnssec=$(echo "$result" | jq -r '.dnssec_enabled')
  spf=$(echo "$result" | jq -r '.spf_valid')
  dkim=$(echo "$result" | jq -r '.dkim_valid')
  mta=$(echo "$result" | jq -r '.mta_sts_enabled')
  tls=$(echo "$result" | jq -r '.smtp_starttls_587')

  echo "$domain,$dnssec,$spf,$dkim,$mta,$tls" >> scorecard.csv
done

echo "Scorecard generated: scorecard.csv"</code></pre>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            body.classList.add('dark-mode');
        }

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            const isDark = body.classList.contains('dark-mode');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        // Copy Code Function
        function copyCode(button) {
            const codeBlock = button.nextElementSibling;
            const code = codeBlock.textContent;

            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');

                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        // Search Documentation
        function searchDocs() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const sections = document.querySelectorAll('.command-box, section');

            sections.forEach(section => {
                const text = section.textContent.toLowerCase();
                if (text.includes(searchTerm) || searchTerm === '') {
                    section.style.display = '';
                } else {
                    section.style.display = 'none';
                }
            });
        }

        // Syntax highlighting
        hljs.highlightAll();
    </script>
</body>
</html>
